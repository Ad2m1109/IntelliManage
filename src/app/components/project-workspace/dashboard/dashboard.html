<div class="dashboard-container" *ngIf="!loading; else loadingState">
    <div class="dashboard-grid">
        <!-- Overall Progress -->
        <div class="dashboard-card progress-card">
            <h3>Overall Progress</h3>
            <div class="progress-circle-container">
                <div class="progress-circle" [style.--progress]="stats.overallProgress + '%'">
                    <span class="progress-value">{{ stats.overallProgress | number:'1.0-2' }}%</span>
                </div>
            </div>
            <p class="card-footer">Project is on track</p>
        </div>

        <!-- Task Distribution -->
        <div class="dashboard-card distribution-card">
            <h3>Task Distribution</h3>
            <div class="distribution-list">
                <div class="distribution-item" *ngFor="let key of getTaskDistributionKeys()">
                    <span class="status-label">{{ key }}</span>
                    <div class="distribution-bar">
                        <div class="bar-fill" [style.width]="(stats.taskDistribution[key] * 5) + '%'"></div>
                    </div>
                    <span class="count">{{ stats.taskDistribution[key] }}</span>
                </div>
            </div>
        </div>

        <!-- Alerts/Indicators -->
        <div class="dashboard-card alerts-card">
            <h3>Project Health</h3>
            <div class="alerts-list">
                <div class="alert-item overdue" [class.active]="stats.overdueTasks > 0">
                    <span class="alert-icon">‚è∞</span>
                    <div class="alert-content">
                        <span class="alert-title">Overdue Tasks</span>
                        <span class="alert-value">{{ stats.overdueTasks }}</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Sprints Timeline -->
        <div class="dashboard-card timeline-card">
            <h3>Sprints Timeline</h3>
            <div class="timeline-container">
                <div class="timeline-track">
                    <div class="timeline-event"
                         *ngFor="let sprint of stats.allSprints"
                         [class.active-sprint]="sprint.status === 'ACTIVE'"
                         [class.completed-sprint]="sprint.status === 'COMPLETED'"
                         [class.planned-sprint]="sprint.status === 'PLANNED'"
                         [style.left]="getSprintPosition(sprint)"
                         [style.width]="getSprintWidth(sprint)"
                         [attr.data-start]="sprint.startDate | date:'shortDate'"
                         [attr.data-end]="sprint.endDate | date:'shortDate'">
                        <div class="timeline-sprint-name">{{ sprint.name }}</div>
                        <div class="timeline-sprint-dates">{{ sprint.startDate | date:'shortDate' }} - {{ sprint.endDate | date:'shortDate' }}</div>
                    </div>
                    <div class="current-date-indicator" [style.left]="getCurrentDatePosition()"></div>
                </div>
            </div>
            <ng-template #noSprintsTimeline>
                <p class="empty-state">No sprints to display in timeline.</p>
            </ng-template>
        </div>
    </div>

    <div class="role-badge" [class]="userRole.toLowerCase()">
        {{ userRole }} VIEW
    </div>
</div>

<ng-template #loadingState>
    <div class="loading-container">
        <div class="spinner"></div>
        <p>Calculating dashboard metrics...</p>
    </div>
</ng-template>