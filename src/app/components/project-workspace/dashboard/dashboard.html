<div class="dashboard-container" *ngIf="!loading; else loadingState">
    <div class="dashboard-grid">
        <!-- Overall Progress -->
        <div class="dashboard-card progress-card">
            <h3>Overall Progress</h3>
            <div class="progress-circle-container">
                <div class="progress-circle" [style.--progress]="stats.overallProgress + '%'">
                    <span class="progress-value">{{ stats.overallProgress }}%</span>
                </div>
            </div>
            <p class="card-footer">Project is on track</p>
        </div>

        <!-- Active Sprint -->
        <div class="dashboard-card sprint-card">
            <h3>Active Sprint</h3>
            <div class="sprint-info" *ngIf="stats.activeSprint; else noSprint">
                <h4 class="sprint-name">{{ stats.activeSprint.name }}</h4>
                <p class="sprint-goal">{{ stats.activeSprint.goal }}</p>
                <div class="sprint-progress">
                    <div class="progress-bar">
                        <div class="progress-fill" [style.width]="stats.activeSprint.progress + '%'"></div>
                    </div>
                    <span>{{ stats.activeSprint.progress }}%</span>
                </div>
                <p class="sprint-deadline">Ends: {{ stats.activeSprint.endDate | date }}</p>
            </div>
            <ng-template #noSprint>
                <p class="empty-state">No active sprint</p>
            </ng-template>
        </div>

        <!-- Task Distribution -->
        <div class="dashboard-card distribution-card">
            <h3>Task Distribution</h3>
            <div class="distribution-list">
                <div class="distribution-item" *ngFor="let key of getTaskDistributionKeys()">
                    <span class="status-label">{{ key }}</span>
                    <div class="distribution-bar">
                        <div class="bar-fill" [style.width]="(stats.taskDistribution[key] * 5) + '%'"></div>
                    </div>
                    <span class="count">{{ stats.taskDistribution[key] }}</span>
                </div>
            </div>
        </div>

        <!-- Alerts/Indicators -->
        <div class="dashboard-card alerts-card">
            <h3>Project Health</h3>
            <div class="alerts-list">
                <div class="alert-item blocked" [class.active]="stats.blockedTasks > 0">
                    <span class="alert-icon">üö´</span>
                    <div class="alert-content">
                        <span class="alert-title">Blocked Tasks</span>
                        <span class="alert-value">{{ stats.blockedTasks }}</span>
                    </div>
                </div>
                <div class="alert-item overdue" [class.active]="stats.overdueTasks > 0">
                    <span class="alert-icon">‚è∞</span>
                    <div class="alert-content">
                        <span class="alert-title">Overdue Tasks</span>
                        <span class="alert-value">{{ stats.overdueTasks }}</span>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <div class="role-badge" [class]="userRole.toLowerCase()">
        {{ userRole }} VIEW
    </div>
</div>

<ng-template #loadingState>
    <div class="loading-container">
        <div class="spinner"></div>
        <p>Calculating dashboard metrics...</p>
    </div>
</ng-template>