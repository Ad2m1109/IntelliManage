<div class="tasks-container">
    <div class="header">
        <h2>Tasks</h2>
        <button class="btn-primary" *ngIf="isFounder && !showTaskForm" (click)="createTask()">+ New Task</button>
    </div>

    <div *ngIf="!showTaskForm">
        <!-- Kanban Board View (For All Users) -->
        <div class="kanban-board" cdkDropListGroup>
            <div *ngFor="let status of taskStatuses" class="kanban-column">
                <div class="kanban-column-header">
                    <h3>{{ status.replace('_', ' ') }}</h3>
                    <span>{{ kanbanColumns[status].length }}</span>
                </div>
                <div class="kanban-tasks" [id]="status" cdkDropList [cdkDropListData]="kanbanColumns[status]" (cdkDropListDropped)="drop($event)">
                    <div class="task-card kanban-card" *ngFor="let task of kanbanColumns[status]" cdkDrag>
                        <div class="task-header">
                            <h3>{{ task.title }}</h3>
                        </div>
                        <p class="task-description">{{ task.description }}</p>
                        <div class="task-footer">
                            <span class="priority" [class]="task.priority.toLowerCase()">{{ task.priority }}</span>
                            <!-- Founder Actions -->
                            <div class="task-actions" *ngIf="isFounder">
                                <button class="btn-edit" (click)="editTask(task)">Edit</button>
                                <button class="btn-assign" (click)="assignTask(task)">Assign</button>
                            </div>
                        </div>
                        <div *cdkDragPlaceholder class="cdk-drag-placeholder"></div>
                    </div>
                    <div class="empty-column-message" *ngIf="kanbanColumns[status].length === 0">
                        No tasks here.
                    </div>
                </div>
            </div>
        </div>
    </div>

    <app-task-form *ngIf="showTaskForm" [task]="taskToEdit" (taskSubmitted)="handleTaskSubmitted($event)" (cancel)="handleCancel()">
    </app-task-form>
</div>
